---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: "{{ .Release.Name }}-eventhandler"
  namespace: {{ .Release.Namespace }}
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
---
apiVersion: monitoring.grafana.com/v1alpha1
kind: Integration
metadata:
  labels:
    agent: {{ .Release.Name }}
  name: "{{ .Release.Name }}-eventhandler"
  namespace: {{ .Release.Namespace }}
spec:
  config:
    cache_path: /etc/eventhandler/eventhandler.cache
    logs_instance: "{{ .Release.Namespace }}/{{ .Release.Name }}-logs"
  name: eventhandler
  type:
    unique: true
  volumeMounts:
    - mountPath: /etc/eventhandler
      name: "{{ .Release.Name }}-eventhandler"
  volumes:
    - name: "{{ .Release.Name }}-eventhandler"
      persistentVolumeClaim:
        claimName: "{{ .Release.Name }}-eventhandler"
