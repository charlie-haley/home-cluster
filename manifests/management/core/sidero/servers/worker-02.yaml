---
apiVersion: metal.sidero.dev/v1alpha1
kind: Server
metadata:
  labels:
    worker-node: 'true'
  name: 4c4c4544-0030-4a10-8038-b7c04f563032
spec:
  pxeBootAlways: true
  bmc:
    endpoint: 192.168.1.121
    userFrom:
      secretKeyRef:
        name: ipmi-credentials
        namespace: sidero
        key: username
    passFrom:
      secretKeyRef:
        name: ipmi-credentials
        namespace: sidero
        key: password
  configPatches:
    - op: replace
      path: /machine/install/disk
      value: /dev/sda
    - op: add
      path: /machine/files
      value:
        - content: |
            [plugins."io.containerd.runtime.v1.linux"]
                shim = "containerd-shim"
                runtime = "nvidia-container-runtime"
          path: /var/cri/conf.d/runtime.toml
          op: create
    - op: replace
      path: /machine/install/image
      value: ghcr.io/charlie-haley/talos-installer:sha-e98e242
  environmentRef:
    namespace: default
    name: default-amd64
  accepted: true
  cpu:
    manufacturer: Intel(R) Corporation
    version: NotSupport
  hostname: 192.168.1.223
  system:
    family: Unknown
    manufacturer: Dell Inc.
    productName: PowerEdge R210 II
    serialNumber: Unknown
    skuNumber: Unknown
    version: 70J8V02
